{% extends 'base.html' %}

{% block style %}
<style>
    @font-face {
    font-family: 'CookieRun-Regular';
    src: url('https://cdn.jsdelivr.net/gh/projectnoonnu/noonfonts_2001@1.1/CookieRun-Regular.woff') format('woff');
    }

    body{
    font-family: 'CookieRun-Regular';
    }

    hr{
        border-color: pink;
    }

    /*<div>로 한 쪽 끝이 접힌 종이 모양 만들기*/
    .note_detail{
        width: 100%;
        height: 700px;
        margin-top: 30px;
        padding: 60px 30px 0px 30px;
        background: #ffe0dd;
        position: relative;
        overflow: auto;
    }
    .note_detail::before{
        content: "";
        left: 0;
        top: 0;
        border-top: 50px solid #fff;
        border-right: 50px solid transparent;
        position: absolute;
    }
    .note_detail::after{
        content: "";
        left: 0;
        top: 0;
        border-bottom: 49px solid #ffc002;
        border-left: 49px solid transparent;
        position: absolute;
    }

    /*삭제 및 쪽지함 버튼 꾸미기*/
    .btn{
        float: right;
    }
    .btn > a{
        color: black;
    }
    .btn > a:hover{
        text-decoration: none;
        color: #f27f3d;
    }

    /*답장 작성 폼 스타일*/
    .re_note_form{
        width: 90%;
        border: solid pink;
        outline: none;
    }
    .renote_btn{
        background: transparent;
        border: none;
        outline: none;
        margin-left: 5px;
    }
    .renote_btn:hover{
        color: #f27f3d; 
    }
</style>

{% endblock %}

{% block content %}
<div class="note_detail">
    <div>
        <button class="btn"><a href="{% url 'note_delete' note_detail.id %}">삭제</a></button>
        <button class="btn"><a href="{% url 'box' %}">쪽지함</a></button>
        
        {% if note_detail.sender == request.user %}
            <p><strong>받는 사람: {{note_detail.receiver}}</strong></p>
        {% else %}
            <p><strong>보낸 사람: {{note_detail.sender}}</strong></p>
        {% endif %}

        <p>{{note_detail.date|date:"Y.m.d"}}</p>
        <p>{{note_detail.content}}</p>
    </div>
    <hr>

    <!--답장 작성하는 폼-->
    <form method="POST" action="{% url 'renote' note_detail.id %}">
        {% csrf_token %}
        {{renote_form}}
        <input type="submit" value="보내기" class="renote_btn">
    </form>
    <br>

     <!--해당 쪽지에 대한 답장 목록
        ReNote가 Note를 외래키로 참조하기 때문에 아래와 같이 작성이 가능-->
    {% for renote in note_detail.renote_set.all %}
        <p><strong>{{renote.author}}</strong>_{{renote.time|date:"Y.m.d"}}</p>
        <p>{{renote.content}} </p>
        <hr>
    {% endfor %}
</div>
{% endblock %} 