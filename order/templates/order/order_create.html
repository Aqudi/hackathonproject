{% extends 'base.html' %}
{% load static %}

{% block script %}
<script type="text/javascript">
    csrf_token = '{{csrf_token}}';
    order_create_url = '{% url "orders:order_create_ajax" %}';
    order_checkout_url = '{% url "orders:order_checkout" %}';
    order_validation_url = '{% url "orders:order_validation" %}';
    order_complete_url = '{% url "orders:order_complete" %}';
</script>
<script src="https://cdn.iamport.kr/js/iamport.payment-1.1.8.js" type="text/javascript"></script>
<script src="{% static '/js/checkout.js' %}" type="text/javascript"></script>
{% endblock %}

{% block content %}
<div class="order">
<div class="paper">
    <div class="lines">
      <div class="text" contenteditable spellcheck="false">
        <h3>{{request.user}}님의 주문 내역</h3>
        <table>
            <th>제품</th>
            <th>수량</th>
            <th>가격</th>

            {% for item in cart %}
                <tr class="order_list">
                    <td>{{item.product.name}}</td>
                    <td>{{item.quantity}}</td>
                    {% load humanize %}
                    <td>{{item.total_price|floatformat|intcomma}}</td>
                </tr>
            {% endfor %}
                <tr class="total">
                    <td colspan=2>Total</td>
                    <td>{{cart.get_total_price|floatformat|intcomma}}원</td>
                </tr>
        </table>
    </div>
    </div>
      <div class="holes hole-top"></div>
      <div class="holes hole-middle"></div>
</div>
</div>

<br>
    <div class="order_info">
        <h3>구매자 정보 입력</h3>
        <hr>
        <div class="order_info_form">
            <form action="" method="post">
                {% csrf_token %}
                {{form.as_p}}
                <input type="hidden" name="pre_order_id" value="0">
                <input type="hidden" name="amount" value="{{cart.get_total_price}}">
                <input type="submit" value="주문하기" class="btn btn-lg btn-success">
            </form>
        </div>
    </div>
{% endblock %}

{% block extra_script %}

{% endblock %}